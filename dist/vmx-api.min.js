/*! vmx-api - v0.1.0 - 2015-03-13
* Copyright (c) 2015 ; Licensed  */
var vmxApi,VmxApi;!function(){"use strict";var a,b=!1,c={},d={};VmxApi=function(){return this};var e=function(a,b){this.detections=a,this.params=b},f=function(a,b,c){if(!d[a])return this;var e=d[a],f=b[0].score,g=e.onEnter;g&&f>=g.minScore&&((!g.lastMet||g.lastMet+g.minTime<=c)&&g.callback(g.params),g.lastMet=c);var h=e.onLeave;h&&f<h.minScore?(void 0===h.startedLeaving&&(h.startedLeaving=c),h.canFire&&h.startedLeaving+h.minTime<=c&&(h.canFire=!1,h.callback(h.params)),h.lastMet=c):h&&(h.canFire=!0,h.startedLeaving=void 0)},g=function(a,b,c,e,f){f||(f={});var g=f.minScore||.1,h=f.minTime||500,i=f.canFire;if(d[a]||(d[a]={}),d[a][b]={callback:c,params:e,minScore:g,minTime:h,lastMet:void 0,canFire:void 0},"onLeave"===b){var j=d[a].onEnter;(j&&j.lastMet||i)&&(d[a][b].canFire=!0)}};VmxApi.prototype.reset=function(){c={},d={}},VmxApi.prototype.select=function(a){return this.selector=a,a&&!(this.$selected=c[a])&&(this.$selected=null),this},VmxApi.prototype.processServerResponse=function(a){var b,d=a.detections,g=a.detectorParams,h=a.name||d[0].name,i=a.connectionId,j=(new Date).getTime();return f(h,d,j),(b=c[h])?b[i]=d:(b=new e(d,g),c[h]={},c[h][i]=b),this},VmxApi.prototype.onEnter=function(a,b,c){return g(this.selector,"onEnter",a,b,c),this},VmxApi.prototype.onLeave=function(a,b,c){return g(this.selector,"onLeave",a,b,c),this},VmxApi.prototype.everDetected=function(a){if(a){var b={name:"Too many parameters",message:"This functin takes no params!"};throw b}return null!==this.$selected&&!!this.$selected},VmxApi.prototype.getSelector=function(){return this.selector},VmxApi.prototype.params=function(a,b){var c=null;return c=null===b?!0:!1,console.log(this.$selected),this},vmxApi=function(c){return b||(a=new VmxApi,b=!0),c?a.select(c):a},vmxApi(),vmxApi.reset=a.reset,vmxApi.processServerResponse=a.processServerResponse,vmxApi.fn=VmxApi.prototype}();