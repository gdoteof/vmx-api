/*! vmx-api - v0.0.0 - 2013-11-08
* Copyright (c) 2013 ; Licensed  */
var vmxApi;!function(){"use strict";function a(){var a={},b={},c=function(a,c,d){if(!b[a])return this;var e=b[a],f=c[0].score,g=e.onEnter;g&&f>=g.minScore&&((!g.lastMet||g.lastMet+g.minTime<=d)&&g.callback(g.params),g.lastMet=d);var h=e.onLeave;h&&f<h.minScore?(void 0===h.startedLeaving&&(h.startedLeaving=d),h.canFire&&h.startedLeaving+h.minTime<=d&&(h.canFire=!1,h.callback(h.params)),h.lastMet=d):h&&(h.canFire=!0,h.startedLeaving=void 0)},d=function(a,c,d,e,f){var g=f.minScore||.1,h=f.minTime||3e4,i=f.canFire;if(b[a]||(b[a]={}),b[a][c]={callback:d,params:e,minScore:g,minTime:h,lastMet:void 0,canFire:void 0},"onLeave"===c){var j=b[a].onEnter;(j&&j.lastMet||i)&&(b[a][c].canFire=!0)}};return{reset:function(){a={},b={}},select:function(b){return this.selector=b,b&&!(this.$selected=a[b])&&(this.$selected=null),this},processServerResponse:function(b){var d,e=b.detections,f=b.name||e[0].cls,g=b.connectionId,h=(new Date).getTime();return c(f,e,h),(d=a[f])?d[g]=e:(a[f]={},a[f][g]=e),this},onEnter:function(a,b,c){return d(this.selector,"onEnter",a,b,c),this},onLeave:function(a,b,c){return d(this.selector,"onLeave",a,b,c),this},everDetected:function(a){if(a){var b={name:"Too many parameters",message:"This functin takes no params!"};throw b}return null!==this.$selected&&!!this.$selected}}}var b,c=!1;vmxApi=function(d){return c||(b=new a,c=!0),d?b.select(d):b},vmxApi(),vmxApi.reset=b.reset,vmxApi.processServerResponse=b.processServerResponse}();